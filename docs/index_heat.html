<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css" integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ==" crossorigin=""/>
    <script src="//d3js.org/topojson.v1.js"></script>
    <script src="//d3js.org/d3.v4.js" charset="utf-8"></script>
      <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js" integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin=""></script>
      <script src="leaflet-heat.js"></script>
    <style media="screen">
    #map {
        width: 100%;
        height: 580px;
    }
    </style>
  </head>
  <body>
  <div id="map"></div>
  <script>
    d3.queue()
        .defer(d3.json, 'estaciones.json')
        .await(function(error, estaciones) {
            console.log(estaciones.data.length);

            var map = L.map('map').setView([43.3609723,-8.4152847], 13  );

            L.tileLayer('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {
              	maxZoom: 19,
              	attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>, Tiles courtesy of <a href="http://hot.openstreetmap.org/" target="_blank">Humanitarian OpenStreetMap Team</a>'
            }).addTo(map);

            for (var i = 0; i < estaciones.data.length; i++) {
              var el = estaciones.data[i];
              var coor = el.Feed.geometry.coordinates;

                L.marker([coor[1], coor[0]]).addTo(map)
                  .bindPopup(el.Feed.assetName)

            }
        });




  </script>
  </body>
</html>
